<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title>Singgit</title>
		<link rel="stylesheet" href="lib/framework7/css/framework7.ios.min.css">
		<link rel="stylesheet" href="lib/framework7/css/framework7.ios.colors.min.css">
		<link rel="stylesheet" href="lib/framework7/css/app.css">
		<link rel="stylesheet" href="lib/icomoon/style.css">
	</head>
	<body>
		<div id="singgit" class="framework7-root">
			<div class="statusbar-overlay"></div>
			<div class="views">
				<div class="view view-main">
				
					<div class="navbar">
					  <div class="navbar-inner">
							<template v-if="activeTab=='new'">
								<div class="center">New Transaction</div>
							</template>
							<template v-else-if="activeTab=='edit'">
								<div class="center">Edit Transaction</div>
							</template>
							<template v-else-if="activeTab=='transactions' || activeTab=='statistic'">
								<div class="searchbar-input" :class="{invisible:activeTab=='statistic'}">
									<input type="search" placeholder="Search" v-model="search">
								</div>
								<select v-model="activeMonth" @change="activeTab=='transactions'?showTransactions():showStatistic()">
									<option v-for="item in 12" :value="(item<10?'0':'')+item" :selected="(item<10?'0':'')+item==activeMonth">{{months[item-1]}}</option>
								</select>
								<select v-model="activeYear">
									<option v-for="item in years" :value="item" :selected="item==activeYear">{{item}}</option>
								</select>
							</template>
							<template v-else-if="activeTab=='config'">
								<div class="center">Configuration</div>
							</template>
						</div>
					</div>
					
					<div class="progressbar-infinite color-multi hide"></div>
					
					<div class="pages navbar-through toolbar-through">
						<div class="page">
							<div class="page-content">
								<div class="tabs">
								
									<!-- ======================================================================================================= Tab Form -->
									<div id="tabForm" class="tab active">
										<form class="list-block inset">
											<ul>
												<li>
													<div class="item-content">
														<div class="item-inner">
															<div class="item-title label">Amount</div>
															<div class="item-input">
																<input type="text" id="amount" @input="$('#amount').val($('#amount').val().replace(' ', ''))">
															</div>
														</div>
													</div>
												</li>
												<li>
													<div class="item-content">
														<div class="item-inner">
															<div class="item-title label">Description</div>
															<div class="item-input">
																<input type="text" id="description" autosave="singgit_desc">
															</div>
														</div>
													</div>
												</li>
												<li>
													<div class="item-content">
														<div class="item-inner">
															<div class="item-title label">Date</div>
															<div class="item-input">
																<input type="text" id="date">
															</div>
														</div>
													</div>
												</li>
												<li>
													<div class="item-content">
														<div class="item-inner">
															<div class="item-title label">Repeat X-Times</div>
															<div class="item-input">
																<input type="number" id="repeat" value="1" min="1">
															</div>
														</div>
													</div>
												</li>
												<li id="account">
													<a href="#" data-back-on-select="true" class="item-link smart-select">
														<div class="item-content">
															<div class="item-inner">
																<div class="item-title label">Account</div>
																<div class="item-input">
																	<select @change="$nextTick(function(){ $('#account .item-after').text($('#account select').val()) })">
																		<option v-for="item in accounts" :value="item">{{item}}</option>
																	</select>
																</div>
																<!--<div class="item-after">Wallet</div>-->
															</div>
														</div>
													</a>
												</li>
												<li id="categories">
													<a href="#" class="item-link smart-select">
														<div class="item-content">
															<div class="item-inner">
																<div class="item-title label">Categories</div>
																<div class="item-input">
																	<select multiple="multiple">
																		<option v-for="item in categories" :value="item">{{item}}</option>
																	</select>
																</div>
																<!--<div class="item-after">Wallet</div>-->
															</div>
														</div>
													</a>
												</li>
												<li id="transfer">
													<a href="#" data-back-on-select="true" class="item-link smart-select">
														<div class="item-content">
															<div class="item-inner">
																<div class="item-title label">Transfer To</div>
																<div class="item-input">
																	<select @change="$nextTick(function(){ $('#transfer .item-after').text($('#transfer select').val()) })">
																		<option value=""></option>
																		<option v-for="item in accounts" :value="item">{{item}}</option>
																	</select>
																</div>
																<!--<div class="item-after">Wallet</div>-->
															</div>
														</div>
													</a>
												</li>
											</ul>
										</form>
										<div class="content-block">
											<div class="buttons-row">
												<template v-if="activeTab=='new'"><a href="#" class="button-round button-fill button-big button" @click="newTransaction()">Reset</a></template>
												<template v-else><a href="#" class="button-round button-fill button-big button" @click="cancelTransaction()">Cancel</a></template>
												<a href="#" class="button-round button-fill button-big button" @click="saveTransaction()">Save</a>
											</div>
										</div>
									</div>
									
									<!-- ======================================================================================================= Tab Transactions -->
									<div id="tabTransactions" class="tab">
										<div class="list-block inset">
											<ul>
												<li class="swipeout" v-for="item in transactions" :key="item.id" :id="item.id" v-if="item.description.indexOf(search)>-1">
													<div class="item-content swipeout-content" @click="editTransaction(item.id)">
														<div class="item-inner">
															<template v-if="item.description!='Reconcile'">
																<div class="transactionDate">{{item.formatteddate}}</div>
																<div class="transactionDescription">
																	{{item.description}}<br>
																	{{item.account[0]}}
																	<template v-if="item.account[1]==''">: <span class="transactionCategories">{{item.categories.join(', ')}}</span></template>
																	<span v-else>to {{item.account[1]}} </span>
																</div>
																<div class="transactionAmount" :class="{negative:item.negative}">
																	{{item.amount}} 
																</div>
															</template>
															<div v-else class="reconcile"></div>
														</div>
													</div>
													<div class="swipeout-actions-left">
														<a href="#" class="swipeout-delete" @click="deleteTransaction(item.id)"><i class="icon-trash"></i></a>
													</div>
												</li>
											</ul>
										</div>
									</div>
									
									<!-- ======================================================================================================= Tab Statistic -->
									<div id="tabStatistic" class="tab">
										<div class="list-block inset">
											<ul>
												<li class="item-content">
													<div class="item-inner">
														statistic
													</div>
												</li>
											</ul>
										</div>
									</div>
									
									<!-- ======================================================================================================= Tab Statistic -->
									<div id="tabConfig" class="tab">
										<div class="list-block inset">
											<ul>
												<li class="item-content">
													<div class="item-inner">
														v20171229d
													</div>
												</li>
											</ul>
										</div>
									</div>
									
								</div>
							</div>
						</div>
					</div>
					<div class="toolbar tabbar">
						<div class="toolbar-inner">
							<a href="#tabForm" class="tab-link active" @click="newTransaction()"><i class="icon-plus"></i></a>
							<a href="#tabTransactions" class="tab-link" @click="showTransactions()"><i class="icon-list-ul"></i></a>
							<a href="#tabStatistic" class="tab-link" @click="activeTab='statistic'"><i class="icon-line-chart"></i></a>
							<a href="#tabConfig" class="tab-link" @click="showLog()"><i class="icon-sliders"></i></a>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!--<div id="toast">Saved</div>-->

		<script src="lib/jquery/jquery-3.2.1.slim.min.js"></script>
		<script src="lib/firebase/firebase.js"></script>
		<script src="lib/firebase/firebase-firestore.js"></script>
		<script src="lib/framework7/js/framework7.min.js"></script>
		<script src="lib/framework7/js/vue.min.js"></script>
		<script src="lib/moment/moment.min.js"></script>
		<script src="lib/framework7/js/app.js"></script>

		<!--
		<script src="lib/framework7/js/framework7-vue.min.js"></script>
		-->
	</body>
</html>